/* !
ARIA Menu Module R1.0
Copyright 2010-2012 Bryan Garaventa (WhatSock.com)
Part of AccDC, a Cross-Browser JavaScript accessibility API, distributed under the terms of the GNU LGPL
	*/
(function(b){$A.setMenu=function(c,g,e,h,f,d){$A.bind(b,"load",function(){var j={},l=f?$A.getEl(g):$A.createEl("div"),k=h||function(){},m=function(n){a("ul.menu","ul.menu li",n);var o=[];$A.query("li.submenu",n.containerDiv,function(){o.push({id:n.id+this.id,role:"SubMenu",bind:"click",isTab:true,tabRole:"",tabState:"Open",trigger:this,topLvlId:n.topLvlId+this.id,source:j[n.topLvlId+this.id],autoPosition:3,runBefore:function(p){if(p.parent){p.offsetLeft=-(p.parent.accDCObj.offsetWidth/2)}p.offsetTop=-p.triggerObj.offsetHeight},runAfter:m,cssObj:{position:"relative",zIndex:n.cssObj.zIndex+1},className:"menu",ariaLevel:n.ariaLevel+1,tabOut:n.tabOut});$A.setAttr(this,"aria-haspopup","true")});$A(n,o);$A.query("li.link",n.containerDiv,function(){$A.bind(this,"click",function(p){n.top.close();if(k&&typeof k==="function"){k(p,this)}p.preventDefault()})})},i=function(){$A.query("ul",l,function(){j[this.id]=this.parentNode.removeChild(this)});$A([{id:e,role:"Menu",bind:"click",isToggle:true,toggleRole:"",toggleState:"Open",trigger:c,topLvlId:e,source:j[e],autoPosition:3,runOnceBefore:function(n){$A.bind(n.triggerObj,"focus",function(o){if(n.loaded&&!("ontouchstart" in b)){n.close()}})},runAfter:m,cssObj:{position:"absolute",zIndex:1},className:"menu",ariaLevel:3,tabOut:function(o,n){if(!("ontouchstart" in b)){n.top.close()}}}],null,true)};if(f){i()}else{$A.load(l,g,i)}$A.setAttr($A.query(c,d)[0],"aria-haspopup","true")})};var a=function(g,f,c){var h=null,e=0;$A.query(g,c.containerDiv,function(){$A.setAttr(this,"role","menu")});var d=$A.query(f,c.containerDiv,function(){$A.setAttr(this,"role","menuitem");$A.setAttr(this,"tabindex",-1);$A.bind(this,{focus:function(k){var j=$A.inArray(this,d);if(j!==-1){e=j}if(h){$A.setAttr(h,"tabindex",-1);$A.setAttr(h,"aria-selected","false")}h=this;$A.setAttr(h,"tabindex",0);$A.setAttr(h,"aria-selected","true")},click:function(i){$A.trigger(this,"focus")},keypress:function(j){var i=j.which||j.keyCode;if(i==27||i==13){if(i==27){c.top.close()}else{if(i==13){$A.trigger(this,"click")}}j.preventDefault()}},keydown:function(j){var i=j.which||j.keyCode;if(i>=37&&i<=40){if(i==37){c.close()}else{if(i==39){$A.trigger(this,"click")}else{if(i==38){e=e===0?d.length-1:e-1}else{if(i==40){e=e===d.length-1?0:e+1}}}}if(i===38||i===40){d[e].focus()}}}})});$A.trigger(d[e],"focus")}})(window);