/*
ARIA Menu Module R2.5
Copyright 2010-2014 Bryan Garaventa (WhatSock.com)
Part of AccDC, a Cross-Browser JavaScript accessibility API, distributed under the terms of the Open Source Initiative OSI - MIT License
	*/
(function(){var b={};$A.setMenu=function(e,n,c,k,l,d,f){var j=l?$A.getEl(n):$A.createEl("div"),m=k||function(){},f=f||{},i=function(o){o.mNode=$A.query((f.menuTag||"ul")+"."+(f.menuClass||"menu"),o.containerDiv)[0],ids=[];var s=parseInt($A.getAttr(o.mNode,"data-offsetleft")),p=parseInt($A.getAttr(o.mNode,"data-offsettop")),u=false,t=$A.getAttr(o.mNode,"data-horizontal"),q=parseInt($A.getAttr(o.mNode,"data-autoposition"));if(!t){t=f.horizontal?"true":"false"}o.hor=t==="true"?true:false;if(!isNaN(s)){o.offsetLeft+=s;u=true}if(!isNaN(p)){o.offsetTop+=p;u=true}if(!isNaN(q)){o.autoPosition=q;u=true}if(u){o.setPosition()}a((f.menuTag||"ul")+"."+(f.menuClass||"menu"),(f.menuTag||"ul")+"."+(f.menuClass||"menu")+" "+(f.itemTag||"li"),o,f);var r=[];$A.query(((f.menuTag||"ul")+"."+(f.menuClass||"menu")+" "+(f.itemTag||"li"))+"."+(f.folderClass||"submenu"),o.containerDiv,function(v,w){r.push({id:o.id+w.id,role:o.role,accStart:o.accStart,accEnd:o.accEnd,bind:"click",isTab:true,tabRole:"",tabState:f.openState||"Open",trigger:w,handler:m,topLvlId:o.topLvlId+w.id,source:b[o.topLvlId+w.id],autoPosition:isNaN(f.autoPosition)?3:f.autoPosition,runBefore:function(y){y.offsetLeft=typeof f.offsetLeft==="number"?f.offsetLeft:(typeof f.offsetLeft==="function"?f.offsetLeft(y):(!f.horizontal&&y.parent?-(y.parent.accDCObj.offsetWidth/2):0));y.offsetTop=typeof f.offsetTop==="number"?f.offsetTop:(typeof f.offsetTop==="function"?f.offsetTop(y):(!f.horizontal?-y.triggerObj.offsetHeight:0))},runDuring:function(y){$A.setAttr(y.accDCObj,"role","application")},runAfter:i,runBeforeClose:g,cssObj:{position:(f.overrides&&f.overrides.cssObj&&f.overrides.cssObj.position)||"relative",zIndex:o.cssObj.zIndex+1},className:f.containerClass||"menu",ariaLevel:o.ariaLevel+1,tabOut:o.tabOut,allowCascade:true});$A.setAttr(w,"aria-haspopup","true");if($A.reg[o.id+w.id]){var x=$A.reg[o.id+w.id];if(x.fn.sraCSSObj){x.fn.sraCSSObj.parentNode.removeChild(x.fn.sraCSSObj)}x.returnFocus=false;x.close();x.returnFocus=true}ids.push(w.id)});$A(o,r,f.overrides);$A.query(((f.menuTag||"ul")+"."+(f.menuClass||"menu")+" "+(f.itemTag||"li"))+"."+(f.linkClass||"link"),o.containerDiv,function(v,w){$A.bind(w,"click",function(x){o.top.close();if(o.handler&&typeof o.handler==="function"){return o.handler.apply(this,[x,o])}});ids.push(w.id)});if(ids.length){$A.setAttr(o.mNode,"aria-owns",ids.join(" "))}},g=function(o){if(o.children.length){for(var p=0;p<o.children.length;p++){o.children[p].close()}}if(o.iNodes&&o.iNodes.length){$A.unbind(o.iNodes,"click keypress keydown")}},h=function(){$A.query((f.menuTag||"ul")+"."+(f.menuClass||"menu"),j,function(p,q){b[q.id]=q.parentNode.removeChild(q)||b[q.id]});if($A.reg[c]){var o=$A.reg[c];if(o.fn.sraCSSObj){o.fn.sraCSSObj.parentNode.removeChild(o.fn.sraCSSObj)}o.returnFocus=false;o.close();o.returnFocus=true}$A([{id:c,role:f.role||"Menu",accStart:f.accStart||"Start",accEnd:f.accEnd||"End",controlType:"MenuControl",bind:"click",isToggle:true,toggleRole:"",toggleState:f.openState||"Open",trigger:e,handler:m,topLvlId:c,source:b[c],autoPosition:isNaN(f.autoPosition)?3:f.autoPosition,runOnceBefore:function(p){$A.bind(p.triggerObj,"focus",function(q){if(p.loaded&&!("ontouchstart" in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)){p.close()}})},runBefore:function(p){$A.find("*",function(q){if(q.controlType&&q.controlType=="MenuControl"&&q.loaded){q.close()}});p.offsetLeft=typeof f.offsetLeft==="number"?f.offsetLeft:(typeof f.offsetLeft==="function"?f.offsetLeft(p):(!f.horizontal&&p.parent?-(p.parent.accDCObj.offsetWidth/2):0));p.offsetTop=typeof f.offsetTop==="number"?f.offsetTop:(typeof f.offsetTop==="function"?f.offsetTop(p):(!f.horizontal?-p.triggerObj.offsetHeight:0))},runDuring:function(p){$A.setAttr(p.accDCObj,"role","application")},runAfter:i,runBeforeClose:g,cssObj:{position:(f.overrides&&f.overrides.cssObj&&f.overrides.cssObj.position)||"absolute",zIndex:(f.overrides&&f.overrides.cssObj&&f.overrides.cssObj.zIndex)||1},className:f.containerClass||"menu",ariaLevel:f.ariaLevel||3,tabOut:function(q,p){if(!("ontouchstart" in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)){p.top.close()}},allowCascade:true}],f.overrides,true)};if(l){h()}else{$A.load(j,n,h)}$A.setAttr($A.query(e,d)[0],"aria-haspopup","true")};var a=function(j,c,k,d){var h=0,e=[],f=function(m){for(var n=h+1;n<=(i.length-1);n++){if(m.toLowerCase()==e[n].replace(/^\s+|\s+$/g,"").substring(0,1).toLowerCase()){h=n;g.apply(i[h]);return}}for(var n=0;n<h;n++){if(m.toLowerCase()==e[n].replace(/^\s+|\s+$/g,"").substring(0,1).toLowerCase()){h=n;g.apply(i[h]);return}}};$A.query(j,k.containerDiv,function(l,m){$A.setAttr(m,"role",k.hor?"menubar":"menu")});var g=function(){var m=this;for(var n=i.length-1;n>=0;n--){if(i[n].id==m.id){h=n}$A.setAttr(i[n],{tabindex:-1,"aria-selected":"false"})}$A.setAttr(m,{tabindex:"0","aria-selected":"true"}).focus()},i=k.iNodes=$A.query(c,k.containerDiv,function(l,m){e.push($A.getText(m));$A.setAttr(m,{role:"menuitem","aria-posinset":l+1,tabindex:-1});$A.bind(m,{keypress:function(o){var n=o.which||o.keyCode;if(n==27){k.close();o.preventDefault()}else{if(n==13){$A.trigger(this,"click");o.preventDefault()}}},keydown:function(o){var n=o.which||o.keyCode;if(n>=37&&n<=40){o.preventDefault();if(k!=k.top&&((n==37&&!k.hor)||(n==38&&k.hor))){k.close()}else{if((n==39&&!k.hor)||(n==40&&k.hor)){if($A.hasClass(this,d.folderClass||"submenu")){$A.trigger(this,"click")}}else{if((n==38&&!k.hor)||(n==37&&k.hor)){h=h<=0?i.length-1:h-1}else{if((n==40&&!k.hor)||(n==39&&k.hor)){h=h>=(i.length-1)?0:h+1}}}}if(((n==38||n==40)&&!k.hor)||((n==37||n==39)&&k.hor)){if(!i[h]||i[h].nodeType!==1){h=0}if(i.length){g.apply(i[h])}}}else{if((n>=48&&n<=57)||(n>=65&&n<=90)){f(String.fromCharCode(n));o.preventDefault()}}}})});$A.query(i,function(l,m){$A.setAttr(m,"aria-setsize",i.length)});g.apply(i[h])};$A.bind(window,"resize",function(){$A.find("*",function(c){if(c.controlType&&c.controlType=="MenuControl"&&c.loaded){c.close()}})})})();