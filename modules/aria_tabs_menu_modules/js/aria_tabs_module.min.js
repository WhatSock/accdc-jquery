/*
ARIA Tabs Module R1.2
Copyright 2010-2013 Bryan Garaventa (WhatSock.com)
Part of AccDC, a Cross-Browser JavaScript accessibility API, distributed under the terms of the Open Source Initiative OSI - MIT License
*/
(function(){$A.setTabs=function(f,k,g,e,m){var h=[],i=[],l="",e=e||document,j=$A.query(f,e,function(p,r){if($A.reg[r.id]){var t=$A.reg[r.id];if(t.fn.sraCSSObj){t.fn.sraCSSObj.parentNode.removeChild(t.fn.sraCSSObj)}t.returnFocus=false;t.close();t.returnFocus=true}var s=r.id||$A.genId(),n={},q=$A.getAttr(r,"data-internal");n.id=s;n.role=$A.getAttr(r,"data-role")||"Tab";n.autoStart=$A.getAttr(r,"data-defaultopen")?true:false;if(n.autoStart){l=p}n.trigger=r;n.mode=typeof k.mode==="number"?k.mode:(k.preload?0:1);n.source=q?(function(){var o=$A.getEl(q);if(o){return o.parentNode.removeChild(o)}else{return $A.reg[r.id]&&$A.reg[r.id].source}})():(function(){var u=$A.createEl("div"),o=$A.getAttr(r,"data-src");o=o.replace("#"," #");if(k.preload){$A.load(u,o,function(){if(k.preloadImages){if(!$A.getEl(a)){document.body.appendChild($A.createEl("div",{id:a},$A.sraCSS))}k.imgLoader=$A.getEl(a);$A.query("img",u,function(v,w){if(w.src&&$A.query('img[src="'+w.src+'"]',k.imgLoader).length<1){k.imgLoader.appendChild($A.createEl("img",{src:w.src,alt:""}))}})}});return u}else{return o}})();n.isStatic="#"+$A.getAttr(r,"data-insert");n.showHiddenClose=k.showHiddenClose||false;n.bind="click";n.ariaLevel=$A.getAttr(r,"data-headinglvl")||k.ariaLevel||3;n.isTab=g?false:true;n.tabRole=g?"":(k.tabRole||"Tab");n.tabState=g?"":(k.tabState||"Selected");n.toggleClass=k.toggleClass||"active";n.runAfter=function(o){$A.query(f,e,function(u,v){$A.remClass(v,o.toggleClass);if(g){$A.setAttr(v,{"aria-expanded":v==o.triggerObj?"true":"false","aria-selected":v==o.triggerObj?"true":"false"})}});$A.addClass(o.triggerObj,o.toggleClass);if(m&&typeof m==="function"){m.apply(o.triggerObj,[o])}};n.runAfterClose=function(o){$A.query(f,e,function(u,v){$A.remClass(v,o.toggleClass);if(g){$A.setAttr(v,{"aria-expanded":"false"})}})};i.push(n);h.push(s)});if(g){b(j[0],h.join(" "));d(f,e,l)}else{c(f,e)}$A(i,k);return h};var d=function(e,i,k){var j=null,g=k||0,f=function(m){var l=$A.inArray(this,h);if(l!==-1){g=l}if(j){$A.setAttr(j,{tabindex:"-1","aria-selected":"false"})}j=this;$A.setAttr(j,{tabindex:"0","aria-selected":"true"});if(!m){j.focus()}},h=$A.query(e,i,function(){$A.setAttr(this,{tabindex:"-1","aria-expanded":"false","aria-selected":"false","aria-label":$A.getText(this)});$A.bind(this,{click:function(l){f.apply(this,[true]);l.preventDefault()},keydown:function(m){var l=m.which||m.keyCode;if(l>=37&&l<=40){if(l==37||l==38){g=g===0?h.length-1:g-1}else{if(l==39||l==40){g=g===h.length-1?0:g+1}}f.apply(h[g]);m.preventDefault()}else{if(l==13||l==32){$A.trigger(h[g],"click");m.preventDefault()}}}})});if(h.length){j=h[0];$A.setAttr(j,"tabindex",0)}},c=function(e,f){$A.query(e,f,function(h,j){var g=j.nodeName.toLowerCase();if(g!="a"&&g!="button"){$A.setAttr(j,{role:"link",tabindex:"0"});$A.bind(j,"keydown",function(l){var i=l.which||l.keyCode;if(i==13){$A.trigger(j,"click");l.preventDefault()}})}})},a="i"+$A.genId(),b=function(g,f){var e=0;while(g){g=g.parentNode;if(g&&e>0&&$A.getAttr(g,"role")=="tablist"){$A.setAttr(g,"aria-owns",f);return}e++}}})();